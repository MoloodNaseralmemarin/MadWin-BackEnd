<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="~/js/toastrHelper.js" asp-append-version="true"></script>



<!--Start AddToCart-->
<script type="text/javascript">
    //   function addToCart(productId) {
    //     $.ajax({
    //         url: '/Cart/AddToCart',
    //         type: 'POST',
    //         data: { productId: productId },
    //         success: function (response) {
    //             const totalCount = response.totalCount || 0;
    //             const totalPrice = response.totalPrice || 0;

    //             const badgeContainer = $("#CartBadgeContainer");
    //             const cartTotal = $("#Cart-total");
    //             const priceTotal = $("#Price-total");
    //             const cartBadge = $("#cartBadge");

    //             // آپدیت عدد و قیمت
    //             cartTotal.text(totalCount);
    //             if (priceTotal.length) {
    //                 priceTotal.text(totalPrice.toLocaleString());
    //             }

    //             // نمایش یا پنهان کردن badge بر اساس تعداد
    //             if (totalCount > 0) {
    //                 badgeContainer.show();
    //                 cartBadge.css({ 'opacity': '1', 'pointer-events': 'auto' });
    //             } else {
    //                 badgeContainer.hide();
    //                 cartBadge.css({ 'opacity': '0.5', 'pointer-events': 'none' });
    //             }

    //             // پیام موفقیت
    //             toastr.success('با موفقیت به سبد خرید اضافه شد.', 'پیام سیستم');
    //         },
    //         error: function () {
    //             toastr.error('خطا در افزودن محصول به سبد خرید.', 'پیام سیستم');
    //         }
    //     });
    // }



    function updateCartUI(response) {
        $("#Cart-total").text(response.totalCount);
        $("#Price-total").text(response.totalPrice.toLocaleString());
        location.reload(); // یا بعداً با Ajax فقط ردیف رو آپدیت می‌کنیم
        return false;
    }

    function increaseCart(productId) {
        $.post('/Cart/Increase', { productId: productId }, function (response) {
            updateCartUI(response);
            return false;
        });
    }

    function decreaseCart(productId) {
        $.post('/Cart/Decrease', { productId: productId }, function (response) {
            updateCartUI(response);
             return false;
        });
    }

    function removeCart(productId) {
        $.post('/Cart/Remove', { productId: productId }, function (response) {
            updateCartUI(response);
            debugger
            toastr.success('محصول انتخابی با موفقیت از سبد خرید حذف شد.');
        }).fail(function () {
            toastr.error('خطا در حذف محصول از سبد خرید. لطفاً دوباره تلاش کنید.');
        });
    }
</script>







